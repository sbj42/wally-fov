(()=>{var t={837:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.computeFieldOfView=void 0;const o=s(i(175)),a=s(i(327)),l=i(273),h=i(785),u=i(878);function c(t,e,i,r,n,s){const{x:o,y:l}=i,c=(Math.min(Math.max(o+n*(r+1),-1),t.width)-o)*n,d=(Math.min(Math.max(l+s*(r+1),-1),t.height)-l)*s;if(c<0||d<0)return;const f=1===s?h.TileFlags.WALL_SOUTH:h.TileFlags.WALL_NORTH,_=1===n?h.TileFlags.WALL_EAST:h.TileFlags.WALL_WEST,T=t.index(i.x,i.y),p=e.visible.index(i.x,i.y);let g=u.initWedges();for(let i=0,r=T,o=p;i!==d&&g.length>0;i++,r+=s*t.width,o+=s*e.visible.width){const s=1/(i+.5),l=0===i?Number.POSITIVE_INFINITY:1/(i-.5);let d=0;for(let T=0,p=r,O=o,y=-.5*s,S=.5*l;T!==c&&d!==g.length;T++,p+=n,O+=n,y+=s,S+=l){for(;y>g[d].high&&(d++,!(d>=g.length)););if(d>=g.length)break;if(S<g[d].low)continue;e.visible.setAtIndex(O,!0);const r=0!=(t.getTileFlagsAtIndex(p)&f),n=0!=(t.getTileFlagsAtIndex(p)&_);if(n&&r)g=u.cutWedges(g,y-a.WALL_OUTSET,S+a.WALL_OUTSET);else if(0===T&&0===i||0==(t.getTileFlagsAtIndex(p)&h.TileFlags.BODY)){if(n){const t=y+s;g=u.cutWedges(g,t-a.WALL_OUTSET,S+a.WALL_OUTSET)}else if(r){const t=y+s;g=u.cutWedges(g,y-a.WALL_OUTSET,t+a.WALL_OUTSET)}}else g=n?u.cutWedges(g,y+a.BODY_INSET,S+a.WALL_OUTSET):r?u.cutWedges(g,y-a.WALL_OUTSET,S-a.BODY_INSET):u.cutWedges(g,y+a.BODY_INSET,S-a.BODY_INSET)}}}e.computeFieldOfView=function(t,e,i,r){const n=new o.Offset(e,i),s=new l.FieldOfViewImpl(n,r);return c(t,s,n,r,-1,-1),c(t,s,n,r,1,-1),c(t,s,n,r,-1,1),c(t,s,n,r,1,1),s}},327:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WEDGE_COUNT=e.WEDGE_HIGH=e.WEDGE_LOW=e.WALL_OUTSET=e.BODY_INSET=void 0,e.BODY_INSET=1e-5,e.WALL_OUTSET=e.BODY_INSET/4,e.WEDGE_LOW=0,e.WEDGE_HIGH=1,e.WEDGE_COUNT=2},273:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.FieldOfViewImpl=void 0;const o=s(i(175));e.FieldOfViewImpl=class{constructor(t,e){this.origin=t,this.chebyshevRadius=e;const i=new o.Rectangle(t.x-e,t.y-e,2*e+1,2*e+1);this.visible=new o.MaskRectangle(i),this.visible.setAtOffset(t,!0)}getVisible(t,e){return this.visible.get(t,e)}toString(){let t="";for(const e of this.visible.locations()){const{x:i,y:r}=e;this.origin.equals(e)?t+="@":this.getVisible(i,r)?t+="-":t+=".",i===this.visible.westX+this.visible.width-1&&(t+="\n")}return t}}},522:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.FieldOfViewMap=void 0;const o=s(i(175)),a=i(785),l=new o.Offset;e.FieldOfViewMap=class{constructor(t,e){this._size=new o.Size,this._size.set(t,e),this._tileFlags=new Array(this._size.area).fill(0)}get width(){return this._size.width}get height(){return this._size.height}addBody(t,e){return this._addFlag(t,e,a.TileFlags.BODY),this}removeBody(t,e){return this._removeFlag(t,e,a.TileFlags.BODY),this}getBody(t,e){const i=this.index(t,e);return 0!=(this.getTileFlagsAtIndex(i)&a.TileFlags.BODY)}addWall(t,e,i){return this._size.contains(t,e)&&(this._addFlag(t,e,1<<i),l.set(t,e),l.addCardinalDirection(i),this._size.containsOffset(l)&&this._addFlag(l.x,l.y,1<<o.cardinalDirectionOpposite(i))),this}removeWall(t,e,i){return this._size.contains(t,e)&&(this._removeFlag(t,e,1<<i),l.set(t,e),l.addCardinalDirection(i),this._size.containsOffset(l)&&this._removeFlag(l.x,l.y,1<<o.cardinalDirectionOpposite(i))),this}getWalls(t,e){const i=this.index(t,e);return a.cardinalDirectionFlagsFromTileFlags(this.getTileFlagsAtIndex(i))}getWall(t,e,i){const r=this.index(t,e);return 0!=(this.getTileFlagsAtIndex(r)&a.tileFlagsForWallAtCardinalDirection(i))}index(t,e){return this._size.index(t,e)}_addFlag(t,e,i){const r=this._size.index(t,e);this._tileFlags[r]|=i}_removeFlag(t,e,i){const r=this._size.index(t,e);this._tileFlags[r]&=~i}getTileFlagsAtIndex(t){return this._tileFlags[t]}}},254:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardinalDirectionFlags=e.CardinalDirection=e.computeFieldOfView=e.FieldOfViewMap=void 0;var r=i(522);Object.defineProperty(e,"FieldOfViewMap",{enumerable:!0,get:function(){return r.FieldOfViewMap}});var n=i(837);Object.defineProperty(e,"computeFieldOfView",{enumerable:!0,get:function(){return n.computeFieldOfView}});var s=i(175);Object.defineProperty(e,"CardinalDirection",{enumerable:!0,get:function(){return s.CardinalDirection}}),Object.defineProperty(e,"CardinalDirectionFlags",{enumerable:!0,get:function(){return s.CardinalDirectionFlags}})},785:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.tileFlagsHasCardinalDirection=e.cardinalDirectionFlagsFromTileFlags=e.tileFlagsForWallAtCardinalDirection=e.TileFlags=void 0;const o=s(i(175));function a(t){return t&o.CardinalDirectionFlags.ALL}var l;(l=e.TileFlags||(e.TileFlags={}))[l.NONE=0]="NONE",l[l.WALL_NORTH=1]="WALL_NORTH",l[l.WALL_EAST=2]="WALL_EAST",l[l.WALL_WEST=8]="WALL_WEST",l[l.WALL_SOUTH=4]="WALL_SOUTH",l[l.BODY=1<<o.CARDINAL_DIRECTIONS.length]="BODY",e.tileFlagsForWallAtCardinalDirection=function(t){return o.cardinalDirectionFlagsFromCardinalDirection(t)},e.cardinalDirectionFlagsFromTileFlags=a,e.tileFlagsHasCardinalDirection=function(t,e){return o.cardinalDirectionFlagsHasCardinalDirection(a(t),e)}},878:(t,e)=>{"use strict";function i(t,e,i){let r;if(e<=t.low)i>=t.high?r=[]:i>=t.low?(t.low=i,r=[t]):r=[t];else if(i>=t.high)e<=t.high?(t.high=e,r=[t]):r=[t];else{const n={low:i,high:t.high};t.high=e,r=[t,n]}return r}Object.defineProperty(e,"__esModule",{value:!0}),e.cutWedges=e.cutWedge=e.initWedges=void 0,e.initWedges=function(){return[{low:0,high:Number.POSITIVE_INFINITY}]},e.cutWedge=i,e.cutWedges=function(t,e,r){const n=new Array;for(const s of t)n.push(...i(s,e,r));return n}},695:(t,e,i)=>{var r={},n=i(525),s=i(549),o=i(251);t.exports=r;var a=1;r.js=function(){var t,e,i,l=1.4,h=!1,u={},c={},d={},f={},_=!0,T={},p=[],g=Number.MAX_VALUE,O=!1;this.setAcceptableTiles=function(t){t instanceof Array?i=t:!isNaN(parseFloat(t))&&isFinite(t)&&(i=[t])},this.enableSync=function(){h=!0},this.disableSync=function(){h=!1},this.enableDiagonals=function(){O=!0},this.disableDiagonals=function(){O=!1},this.setGrid=function(e){t=e;for(var i=0;i<t.length;i++)for(var r=0;r<t[0].length;r++)c[t[i][r]]||(c[t[i][r]]=1)},this.setTileCost=function(t,e){c[t]=e},this.setAdditionalPointCost=function(t,e,i){void 0===d[e]&&(d[e]={}),d[e][t]=i},this.removeAdditionalPointCost=function(t,e){void 0!==d[e]&&delete d[e][t]},this.removeAllAdditionalPointCosts=function(){d={}},this.setDirectionalCondition=function(t,e,i){void 0===f[e]&&(f[e]={}),f[e][t]=i},this.removeAllDirectionalConditions=function(){f={}},this.setIterationsPerCalculation=function(t){g=t},this.avoidAdditionalPoint=function(t,e){void 0===u[e]&&(u[e]={}),u[e][t]=1},this.stopAvoidingAdditionalPoint=function(t,e){void 0!==u[e]&&delete u[e][t]},this.enableCornerCutting=function(){_=!0},this.disableCornerCutting=function(){_=!1},this.stopAvoidingAllAdditionalPoints=function(){u={}},this.findPath=function(e,r,s,l,u){var c=function(t){h?u(t):setTimeout((function(){u(t)}))};if(void 0===i)throw new Error("You can't set a path without first calling setAcceptableTiles() on EasyStar.");if(void 0===t)throw new Error("You can't set a path without first calling setGrid() on EasyStar.");if(e<0||r<0||s<0||l<0||e>t[0].length-1||r>t.length-1||s>t[0].length-1||l>t.length-1)throw new Error("Your start or end point is outside the scope of your grid.");if(e!==s||r!==l){for(var d=t[l][s],f=!1,_=0;_<i.length;_++)if(d===i[_]){f=!0;break}if(!1!==f){var g=new n;g.openList=new o((function(t,e){return t.bestGuessDistance()-e.bestGuessDistance()})),g.isDoneCalculating=!1,g.nodeHash={},g.startX=e,g.startY=r,g.endX=s,g.endY=l,g.callback=c,g.openList.push(F(g,g.startX,g.startY,null,1));var O=a++;return T[O]=g,p.push(O),O}c(null)}else c([])},this.cancelPath=function(t){return t in T&&(delete T[t],!0)},this.calculate=function(){if(0!==p.length&&void 0!==t&&void 0!==i)for(e=0;e<g;e++){if(0===p.length)return;h&&(e=0);var r=p[0],n=T[r];if(void 0!==n)if(0!==n.openList.size()){var s=n.openList.pop();if(n.endX!==s.x||n.endY!==s.y)s.list=0,s.y>0&&y(n,s,0,-1,1*m(s.x,s.y-1)),s.x<t[0].length-1&&y(n,s,1,0,1*m(s.x+1,s.y)),s.y<t.length-1&&y(n,s,0,1,1*m(s.x,s.y+1)),s.x>0&&y(n,s,-1,0,1*m(s.x-1,s.y)),O&&(s.x>0&&s.y>0&&(_||S(t,i,s.x,s.y-1,s)&&S(t,i,s.x-1,s.y,s))&&y(n,s,-1,-1,l*m(s.x-1,s.y-1)),s.x<t[0].length-1&&s.y<t.length-1&&(_||S(t,i,s.x,s.y+1,s)&&S(t,i,s.x+1,s.y,s))&&y(n,s,1,1,l*m(s.x+1,s.y+1)),s.x<t[0].length-1&&s.y>0&&(_||S(t,i,s.x,s.y-1,s)&&S(t,i,s.x+1,s.y,s))&&y(n,s,1,-1,l*m(s.x+1,s.y-1)),s.x>0&&s.y<t.length-1&&(_||S(t,i,s.x,s.y+1,s)&&S(t,i,s.x-1,s.y,s))&&y(n,s,-1,1,l*m(s.x-1,s.y+1)));else{var o=[];o.push({x:s.x,y:s.y});for(var a=s.parent;null!=a;)o.push({x:a.x,y:a.y}),a=a.parent;o.reverse();var u=o;n.callback(u),delete T[r],p.shift()}}else n.callback(null),delete T[r],p.shift();else p.shift()}};var y=function(e,r,n,s,o){var a=r.x+n,l=r.y+s;if((void 0===u[l]||void 0===u[l][a])&&S(t,i,a,l,r)){var h=F(e,a,l,r,o);void 0===h.list?(h.list=1,e.openList.push(h)):r.costSoFar+o<h.costSoFar&&(h.costSoFar=r.costSoFar+o,h.parent=r,e.openList.updateItem(h))}},S=function(t,e,i,r,n){var s=f[r]&&f[r][i];if(s){var o=v(n.x-i,n.y-r);if(!function(){for(var t=0;t<s.length;t++)if(s[t]===o)return!0;return!1}())return!1}for(var a=0;a<e.length;a++)if(t[r][i]===e[a])return!0;return!1},v=function(t,e){if(0===t&&-1===e)return r.TOP;if(1===t&&-1===e)return r.TOP_RIGHT;if(1===t&&0===e)return r.RIGHT;if(1===t&&1===e)return r.BOTTOM_RIGHT;if(0===t&&1===e)return r.BOTTOM;if(-1===t&&1===e)return r.BOTTOM_LEFT;if(-1===t&&0===e)return r.LEFT;if(-1===t&&-1===e)return r.TOP_LEFT;throw new Error("These differences are not valid: "+t+", "+e)},m=function(e,i){return d[i]&&d[i][e]||c[t[i][e]]},F=function(t,e,i,r,n){if(void 0!==t.nodeHash[i]){if(void 0!==t.nodeHash[i][e])return t.nodeHash[i][e]}else t.nodeHash[i]={};var o=A(e,i,t.endX,t.endY);if(null!==r)var a=r.costSoFar+n;else a=0;var l=new s(r,e,i,a,o);return t.nodeHash[i][e]=l,l},A=function(t,e,i,r){var n,s;return O?(n=Math.abs(t-i))<(s=Math.abs(e-r))?l*n+s:l*s+n:(n=Math.abs(t-i))+(s=Math.abs(e-r))}},r.TOP="TOP",r.TOP_RIGHT="TOP_RIGHT",r.RIGHT="RIGHT",r.BOTTOM_RIGHT="BOTTOM_RIGHT",r.BOTTOM="BOTTOM",r.BOTTOM_LEFT="BOTTOM_LEFT",r.LEFT="LEFT",r.TOP_LEFT="TOP_LEFT"},525:t=>{t.exports=function(){this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList}},549:t=>{t.exports=function(t,e,i,r,n){this.parent=t,this.x=e,this.y=i,this.costSoFar=r,this.simpleDistanceToTarget=n,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}}},251:(t,e,i)=>{t.exports=i(208)},208:function(t,e){var i,r,n;(function(){var s,o,a,l,h,u,c,d,f,_,T,p,g,O,y;a=Math.floor,_=Math.min,o=function(t,e){return t<e?-1:t>e?1:0},f=function(t,e,i,r,n){var s;if(null==i&&(i=0),null==n&&(n=o),i<0)throw new Error("lo must be non-negative");for(null==r&&(r=t.length);i<r;)n(e,t[s=a((i+r)/2)])<0?r=s:i=s+1;return[].splice.apply(t,[i,i-i].concat(e)),e},u=function(t,e,i){return null==i&&(i=o),t.push(e),O(t,0,t.length-1,i)},h=function(t,e){var i,r;return null==e&&(e=o),i=t.pop(),t.length?(r=t[0],t[0]=i,y(t,0,e)):r=i,r},d=function(t,e,i){var r;return null==i&&(i=o),r=t[0],t[0]=e,y(t,0,i),r},c=function(t,e,i){var r;return null==i&&(i=o),t.length&&i(t[0],e)<0&&(e=(r=[t[0],e])[0],t[0]=r[1],y(t,0,i)),e},l=function(t,e){var i,r,n,s,l,h;for(null==e&&(e=o),l=[],r=0,n=(s=function(){h=[];for(var e=0,i=a(t.length/2);0<=i?e<i:e>i;0<=i?e++:e--)h.push(e);return h}.apply(this).reverse()).length;r<n;r++)i=s[r],l.push(y(t,i,e));return l},g=function(t,e,i){var r;if(null==i&&(i=o),-1!==(r=t.indexOf(e)))return O(t,0,r,i),y(t,r,i)},T=function(t,e,i){var r,n,s,a,h;if(null==i&&(i=o),!(n=t.slice(0,e)).length)return n;for(l(n,i),s=0,a=(h=t.slice(e)).length;s<a;s++)r=h[s],c(n,r,i);return n.sort(i).reverse()},p=function(t,e,i){var r,n,s,a,u,c,d,T,p;if(null==i&&(i=o),10*e<=t.length){if(!(s=t.slice(0,e).sort(i)).length)return s;for(n=s[s.length-1],a=0,c=(d=t.slice(e)).length;a<c;a++)i(r=d[a],n)<0&&(f(s,r,0,null,i),s.pop(),n=s[s.length-1]);return s}for(l(t,i),p=[],u=0,T=_(e,t.length);0<=T?u<T:u>T;0<=T?++u:--u)p.push(h(t,i));return p},O=function(t,e,i,r){var n,s,a;for(null==r&&(r=o),n=t[i];i>e&&r(n,s=t[a=i-1>>1])<0;)t[i]=s,i=a;return t[i]=n},y=function(t,e,i){var r,n,s,a,l;for(null==i&&(i=o),n=t.length,l=e,s=t[e],r=2*e+1;r<n;)(a=r+1)<n&&!(i(t[r],t[a])<0)&&(r=a),t[e]=t[r],r=2*(e=r)+1;return t[e]=s,O(t,l,e,i)},s=function(){function t(t){this.cmp=null!=t?t:o,this.nodes=[]}return t.push=u,t.pop=h,t.replace=d,t.pushpop=c,t.heapify=l,t.updateItem=g,t.nlargest=T,t.nsmallest=p,t.prototype.push=function(t){return u(this.nodes,t,this.cmp)},t.prototype.pop=function(){return h(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return d(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return c(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return l(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return g(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),r=[],void 0===(n="function"==typeof(i=function(){return s})?i.apply(e,r):i)||(t.exports=n)}).call(this)},586:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.axisAddCardinalTurn=e.axisFromNorthSouthTurn=e.axisFromCardinalDirection=e.axisOrthogonal=e.axisToString=e.AXES=e.Axis=void 0,function(t){t[t.NORTH_SOUTH=0]="NORTH_SOUTH",t[t.WEST_EAST=1]="WEST_EAST"}(i=e.Axis||(e.Axis={})),e.AXES=[i.NORTH_SOUTH,i.WEST_EAST];const r=["N-S","W-E"];e.axisToString=function(t){return r[t]},e.axisOrthogonal=function(t){return 1^t},e.axisFromCardinalDirection=function(t){return 1&t},e.axisFromNorthSouthTurn=function(t){return 1&t},e.axisAddCardinalTurn=function(t,e){return t+e&1}},450:(t,e)=>{"use strict";var i;function r(t){return 1<<t}Object.defineProperty(e,"__esModule",{value:!0}),e.cardinalDirectionFlagsFromCardinalDirection=e.cardinalDirectionFlagsRemoveCardinalDirection=e.cardinalDirectionFlagsSetCardinalDirection=e.cardinalDirectionFlagsHasCardinalDirection=e.cardinalDirectionFlagsToString=e.CardinalDirectionFlags=void 0,function(t){t[t.NONE=0]="NONE",t[t.NORTH=1]="NORTH",t[t.EAST=2]="EAST",t[t.SOUTH=4]="SOUTH",t[t.WEST=8]="WEST",t[t.ALL=15]="ALL"}(i=e.CardinalDirectionFlags||(e.CardinalDirectionFlags={})),e.cardinalDirectionFlagsToString=function(t){let e="[";return 0!=(t&i.NORTH)&&(e+="N"),0!=(t&i.EAST)&&(e+="E"),0!=(t&i.SOUTH)&&(e+="S"),0!=(t&i.WEST)&&(e+="W"),e+"]"},e.cardinalDirectionFlagsHasCardinalDirection=function(t,e){return 0!=(t&r(e))},e.cardinalDirectionFlagsSetCardinalDirection=function(t,e){return t|r(e)},e.cardinalDirectionFlagsRemoveCardinalDirection=function(t,e){return t&~r(e)},e.cardinalDirectionFlagsFromCardinalDirection=r},28:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.cardinalDirectionAddCardinalTurn=e.cardinalDirectionFromCardinalOrientation=e.cardinalDirectionFromNorthTurn=e.cardinalDirectionFromDirection=e.cardinalDirectionOpposite=e.cardinalDirectionToString=e.CARDINAL_DIRECTIONS=e.CardinalDirection=void 0,function(t){t[t.NORTH=0]="NORTH",t[t.EAST=1]="EAST",t[t.SOUTH=2]="SOUTH",t[t.WEST=3]="WEST"}(i=e.CardinalDirection||(e.CardinalDirection={})),e.CARDINAL_DIRECTIONS=[i.NORTH,i.EAST,i.SOUTH,i.WEST];const r=["N","E","S","W"];e.cardinalDirectionToString=function(t){return r[t]},e.cardinalDirectionOpposite=function(t){return t+2&3},e.cardinalDirectionFromDirection=function(t){return t>>1},e.cardinalDirectionFromNorthTurn=function(t){return t},e.cardinalDirectionFromCardinalOrientation=function(t){return t>>>1},e.cardinalDirectionAddCardinalTurn=function(t,e){return t+e&3}},534:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cardinalOrientationAddCardinalTurn=e.cardinalOrientationFromFlipAndCardinalDirection=e.cardinalOrientationReverse=e.cardinalOrientationFlip=e.cardinalOrientationToString=e.CARDINAL_ORIENTATIONS=e.CardinalOrientation=void 0;const r=i(586),n=i(598);var s;!function(t){t[t.HEADS_NORTH=0]="HEADS_NORTH",t[t.TAILS_NORTH=1]="TAILS_NORTH",t[t.HEADS_EAST=2]="HEADS_EAST",t[t.TAILS_EAST=3]="TAILS_EAST",t[t.HEADS_SOUTH=4]="HEADS_SOUTH",t[t.TAILS_SOUTH=5]="TAILS_SOUTH",t[t.HEADS_WEST=6]="HEADS_WEST",t[t.TAILS_WEST=7]="TAILS_WEST"}(s=e.CardinalOrientation||(e.CardinalOrientation={})),e.CARDINAL_ORIENTATIONS=[s.HEADS_NORTH,s.TAILS_NORTH,s.HEADS_EAST,s.TAILS_EAST,s.HEADS_SOUTH,s.TAILS_SOUTH,s.HEADS_WEST,s.TAILS_WEST];const o=["HN","TN","HE","TE","HS","TS","HW","TW"];e.cardinalOrientationToString=function(t){return o[t]},e.cardinalOrientationFlip=function(t,e){return e===r.Axis.NORTH_SOUTH?9-t&7:13-t&7},e.cardinalOrientationReverse=function(t){return t===s.HEADS_EAST?s.HEADS_WEST:t===s.HEADS_WEST?s.HEADS_EAST:t},e.cardinalOrientationFromFlipAndCardinalDirection=function(t,e){return 2*e+(t!==n.Flip.HEADS?1:0)},e.cardinalOrientationAddCardinalTurn=function(t,e){return t+2*e&7}},399:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.cardinalTurnAddCardinalTurn=e.cardinalTurnFromTurn=e.cardinalTurnFromCardinalDirections=e.cardinalTurnReverse=e.cardinalTurnToDegrees=e.cardinalTurnToString=e.CARDINAL_TURNS=e.CardinalTurn=void 0,function(t){t[t.NONE=0]="NONE",t[t.RIGHT=1]="RIGHT",t[t.AROUND=2]="AROUND",t[t.LEFT=3]="LEFT"}(i=e.CardinalTurn||(e.CardinalTurn={})),e.CARDINAL_TURNS=[i.NONE,i.RIGHT,i.AROUND,i.LEFT];const r=["T0","T+90","T180","T-90"];e.cardinalTurnToString=function(t){return r[t]},e.cardinalTurnToDegrees=function(t){return 90*t},e.cardinalTurnReverse=function(t){return 4-t&3},e.cardinalTurnFromCardinalDirections=function(t,e){return e-t&3},e.cardinalTurnFromTurn=function(t){return t>>1},e.cardinalTurnAddCardinalTurn=function(t,e){return t+e&3}},730:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.directionAddCardinalTurn=e.directionAddTurn=e.directionFromCardinalDirection=e.directionOpposite=e.directionIsCardinal=e.directionToString=e.DIRECTIONS=e.Direction=void 0,function(t){t[t.NORTH=0]="NORTH",t[t.NORTHEAST=1]="NORTHEAST",t[t.EAST=2]="EAST",t[t.SOUTHEAST=3]="SOUTHEAST",t[t.SOUTH=4]="SOUTH",t[t.SOUTHWEST=5]="SOUTHWEST",t[t.WEST=6]="WEST",t[t.NORTHWEST=7]="NORTHWEST"}(i=e.Direction||(e.Direction={})),e.DIRECTIONS=[i.NORTH,i.NORTHEAST,i.EAST,i.SOUTHEAST,i.SOUTH,i.SOUTHWEST,i.WEST,i.NORTHWEST];const r=["N","NE","E","SE","S","SW","W","NW"];e.directionToString=function(t){return r[t]},e.directionIsCardinal=function(t){return 0==(1&t)},e.directionOpposite=function(t){return t+4&7},e.directionFromCardinalDirection=function(t){return t<<1},e.directionAddTurn=function(t,e){return t+e&7},e.directionAddCardinalTurn=function(t,e){return t+2*e&7}},598:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.flipFromCardinalOrientation=e.flipFromBoolean=e.flipOpposite=e.flipToString=e.FLIPS=e.Flip=void 0,function(t){t[t.HEADS=0]="HEADS",t[t.TAILS=1]="TAILS"}(i=e.Flip||(e.Flip={})),e.FLIPS=[i.HEADS,i.TAILS];const r=["H","T"];e.flipToString=function(t){return r[t]},e.flipOpposite=function(t){return 1^t},e.flipFromBoolean=function(t){return t?i.TAILS:i.HEADS},e.flipFromCardinalOrientation=function(t){return 1&t}},74:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||r(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(730),e),n(i(35),e),n(i(28),e),n(i(399),e),n(i(450),e),n(i(598),e),n(i(534),e),n(i(586),e)},35:(t,e)=>{"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.turnAddTurn=e.turnFromDirections=e.turnFromCardinalTurn=e.turnFromCardinalDirections=e.turnReverse=e.turnIsCardinal=e.turnToDegrees=e.turnToString=e.TURNS=e.Turn=void 0,function(t){t[t.NONE=0]="NONE",t[t.R_45=1]="R_45",t[t.R_90=2]="R_90",t[t.R_135=3]="R_135",t[t.T_180=4]="T_180",t[t.L_135=5]="L_135",t[t.L_90=6]="L_90",t[t.L_45=7]="L_45"}(i=e.Turn||(e.Turn={})),e.TURNS=[i.NONE,i.R_45,i.R_90,i.R_135,i.T_180,i.L_135,i.L_90,i.L_45];const r=["T0","T+45","T+90","T+135","T180","T-135","T-90","T-45"];e.turnToString=function(t){return r[t]},e.turnToDegrees=function(t){return 45*t},e.turnIsCardinal=function(t){return 0==(1&t)},e.turnReverse=function(t){return 8-t&7},e.turnFromCardinalDirections=function(t,e){return 2*(e-t)&7},e.turnFromCardinalTurn=function(t){return t<<1},e.turnFromDirections=function(t,e){return e-t&7},e.turnAddTurn=function(t,e){return t+e&7}},400:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CardinalPath=void 0;const r=i(74),n=i(317),s=i(82),o=i(64),a=new n.Offset;function l(t,e){t.push(e);let i=t.length-1;for(;i>0&&e<t[i-1];)t[i]=t[i-1],i--;t[i]=e}e.CardinalPath=class{constructor(t,e){this._start=new n.Offset,this._start.copyFrom(t),this._segments=e}toString(){return`${this._start.toString()}:${this._segments.map((t=>r.cardinalDirectionToString(t))).join("")}`}equals(t){return this._start.equals(t._start)&&this._segments.length===t._segments.length&&this._segments.every(((e,i)=>e===t._segments[i]))}get length(){return this._segments.length}getIsClosed(){a.copyFrom(this._start);for(const t of this._segments)a.addCardinalDirection(t);return this._start.equals(a)}*offsets(){let{x:t,y:e}=this._start;yield{x:t,y:e};for(const i of this._segments)a.setFromCardinalDirection(i),t+=a.x,e+=a.y,yield{x:t,y:e}}getBounds(){let t=this._start.y,e=t,i=this._start.x,n=i;a.copyFrom(this._start);for(const s of this._segments)switch(a.addCardinalDirection(s),s){case r.CardinalDirection.NORTH:t=Math.min(t,a.y);break;case r.CardinalDirection.EAST:n=Math.max(n,a.x);break;case r.CardinalDirection.SOUTH:e=Math.max(e,a.y);break;case r.CardinalDirection.WEST:i=Math.min(i,a.x);break;default:throw new Error(`bad direction ${s} in cardinal path`)}return new s.Rectangle(i,t,n-i+1,e-t+1)}getArea(){let t=0;a.copyFrom(this._start);for(const e of this._segments)switch(a.addCardinalDirection(e),e){case r.CardinalDirection.NORTH:t-=a.x;break;case r.CardinalDirection.SOUTH:t+=a.x}return Math.abs(t)}rasterize(t){const e=new Array;void 0===t&&(t=this.getBounds()),a.copyFrom(this._start);const{northY:i}=t,n=i+t.height-1;for(let t=i;t<n;t++)e.push([]);a.copyFrom(this._start);for(const t of this._segments)t===r.CardinalDirection.SOUTH&&l(e[a.y-i],a.x),a.addCardinalDirection(t),t===r.CardinalDirection.NORTH&&l(e[a.y-i],a.x);return new o.RasterMask({westX:t.westX,northY:t.northY,width:t.width-1,height:t.height-1},e)}}},876:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||r(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(317),e),n(i(154),e),n(i(82),e),n(i(971),e),n(i(630),e),n(i(64),e),n(i(400),e),n(i(457),e)},630:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MaskRectangle=void 0;const r=i(82),n=i(971);e.MaskRectangle=class{constructor(t,e=!1,i=!1){this._rect=new r.Rectangle,void 0!==t&&this._rect.copyFrom(t),this._mask=new n.Mask(t,e),this._outsideValue=i}toString(){return`${this._rect.northWest}/${this._outsideValue}\n${this._mask}`}equals(t){return this._rect.equals(t._rect)&&this._mask.equals(t._mask)&&this._outsideValue===t._outsideValue}get westX(){return this._rect.westX}get northY(){return this._rect.northY}get width(){return this._rect.width}get height(){return this._rect.height}get(t,e){return this._rect.contains(t,e)?this._mask.get(t-this.westX,e-this.northY):this._outsideValue}getAtIndex(t){return this._mask.getAtIndex(t)}getAtOffset(t){return this.get(t.x,t.y)}copyFrom(t){return this._rect.copyFrom(t._rect),this._mask.copyFrom(t._mask),this._outsideValue=t._outsideValue,this}set(t,e,i){return this._mask.set(t-this.westX,e-this.northY,i),this}setAtOffset(t,e){return this.set(t.x,t.y,e)}setAtIndex(t,e){return this._mask.setAtIndex(t,e),this}index(t,e){return this._mask.index(t-this.westX,e-this.northY)}*locations(){for(const t of this._mask.locations()){const e=t.x+this.westX,i=t.y+this.northY,{value:r}=t;yield{x:e,y:i,value:r}}}*offsetsWithTrue(){for(const t of this._mask.offsetsWithTrue()){const e=t.x+this.westX,i=t.y+this.northY;yield{x:e,y:i}}}}},971:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mask=void 0;const r=i(154);e.Mask=class{constructor(t,e=!1){this._size=new r.Size,void 0!==t&&this._size.copyFrom(t),this._bits=new Array(Math.ceil(this._size.area/32)).fill(e?4294967295:0)}toString(){let t="";for(let e=0;e<this.height;e++){for(let i=0;i<this.width;i++)t+=this.get(i,e)?"☑":"☐";t+="\n"}return t}equals(t){return this._size.equals(t._size)&&this._bits.length===t._bits.length&&this._bits.every(((e,i)=>e===t._bits[i]))}get width(){return this._size.width}get height(){return this._size.height}get(t,e){return this.getAtIndex(this.index(t,e))}getAtOffset(t){return this.get(t.x,t.y)}getAtIndex(t){const e=t>>>5,i=1<<(31&t);return 0!=(this._bits[e]&i)}copyFrom(t){return this._size.copyFrom(t._size),this._bits=t._bits.slice(),this}set(t,e,i){return this.setAtIndex(this.index(t,e),i)}setAtOffset(t,e){return this.set(t.x,t.y,e)}setAtIndex(t,e){const i=t>>>5,r=1<<(31&t);return e?this._bits[i]|=r:this._bits[i]&=~r,this}index(t,e){return this._size.index(t,e)}*locations(){let t=0,e=1;for(const{x:i,y:r}of this._size.offsets()){const n=0!=(this._bits[t]&e);yield{x:i,y:r,value:n},e===1<<31?(e=1,t++):e<<=1}}*offsetsWithTrue(){for(const{x:t,y:e,value:i}of this.locations())i&&(yield{x:t,y:e})}}},317:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Offset=void 0;const r=i(74),n=[0,1,1,1,0,-1,-1,-1],s=[-1,-1,0,1,1,1,0,-1],o=[0,1,0,-1],a=[-1,0,1,0];e.Offset=class{constructor(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}toString(){return`(${this.x},${this.y})`}equals(t){return this.x===t.x&&this.y===t.y}set(t,e){return this.x=t,this.y=e,this}copyFrom(t){return this.set(t.x,t.y)}setFromDirection(t){return this.set(n[t],s[t])}setFromCardinalDirection(t){return this.set(o[t],a[t])}add(t,e){return this.x+=t,this.y+=e,this}addSize(t){return this.add(t.width,t.height)}addOffset(t){return this.add(t.x,t.y)}addDirection(t){return this.add(n[t],s[t])}addCardinalDirection(t){return this.add(o[t],a[t])}subtractOffset(t){return this.add(-t.x,-t.y)}multiply(t){return this.x*=t,this.y*=t,this}rotate(t,e){if(e)return this.subtractOffset(e).rotate(t).addOffset(e);{const e=r.cardinalDirectionFromNorthTurn(t),{x:i,y:n}=this,s=o[e],l=a[e],h=-n*s-i*l,u=i*s-n*l;return this.set(h,u)}}distanceChebyshev(t){return Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))}distanceManhattan(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}*nearbyChebyshevOffsets(t,e){if(e>=0)for(let i=-e;i<=e;i++)for(let r=-e;r<=e;r++)yield t.set(this.x+r,this.y+i)}}},64:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RasterMask=void 0;const r=i(82);e.RasterMask=class{constructor(t,e){if(this._rect=new r.Rectangle,e.length!==t.height)throw new Error(`bad lines array length ${e.length} for bounds ${t}`);this._rect.copyFrom(t),this._lines=e}toString(){let t="";const{eastX:e}=this._rect;for(let i=0;i<this.height;i++){const r=this._lines[i];let n=this.westX;for(let e=0;e<r.length;e+=2){const i=r[e],s=r[e+1];for(;n<i;)t+="∙",n++;for(;n<s;)t+="█",n++}for(;n<=e;)t+="∙",n++;t+="\n"}return`(${this._rect.westX},${this._rect.northY})\n${t}`}equals(t){return this._rect.equals(t._rect)&&this._lines.length===t._lines.length&&this._lines.every(((e,i)=>e.length===t._lines[i].length&&e.every(((e,r)=>e===t._lines[i][r]))))}get northY(){return this._rect.northY}get southY(){return this._rect.southY}get westX(){return this._rect.westX}get width(){return this._rect.width}get height(){return this._rect.height}get(t,e){if(e<this.northY||e>this._rect.southY)return!1;const i=this._lines[e-this.northY];for(let e=0;e<i.length;e+=2)if(t>=i[e]&&t<i[e+1])return!0;return!1}getAtOffset(t){return this.get(t.x,t.y)}*bandsAt(t){if(t>=this.northY&&t<=this._rect.southY){const e=this._lines[t-this.northY];for(let t=0;t<e.length;t+=2)yield{westX:e[t],eastX:e[t+1]-1}}}}},82:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Rectangle=void 0;const r=i(154),n=i(317),s=[0,0,1,1],o=[0,1,1,0];e.Rectangle=class{constructor(t,e,i,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===s&&(s=0),this.northWest=new n.Offset(t,e),this.size=new r.Size(i,s)}toString(){return`(${this.westX},${this.northY} ${this.width}x${this.height})`}equals(t){return this.westX===t.westX&&this.northY===t.northY&&this.size.equals(t)}get northY(){return this.northWest.y}get southY(){return this.northWest.y+this.size.height-1}get westX(){return this.northWest.x}get eastX(){return this.northWest.x+this.size.width-1}get width(){return this.size.width}get height(){return this.size.height}get empty(){return this.size.empty}get area(){return this.size.area}set(t,e,i,r){return this.northWest.set(t,e),this.size.set(i,r),this}setFromCorners(t,e){const i=Math.min(t.x,e.x),r=Math.max(t.x,e.x),n=Math.min(t.y,e.y),s=Math.max(t.y,e.y);return this.set(i,n,r-i+1,s-n+1)}copyFrom(t){return this.set(t.westX,t.northY,t.width,t.height)}addOffset(t){return this.northWest.addOffset(t),this}scale(t){return this.northWest.multiply(t),this.size.multiply(t),this}rotate(t,e){const i=s[t],r=o[t];return this.northWest.add(i*(this.width-1),r*(this.height-1)).rotate(t,e),this.size.rotate(t),this}extendToInclude(t){const e=t.x-this.westX;e<0?(this.size.width-=e,this.northWest.x=t.x):e>=this.size.width&&(this.size.width=e+1);const i=t.y-this.northWest.y;return i<0?(this.size.height-=i,this.northWest.y=t.y):i>=this.size.height&&(this.size.height=i+1),this}contains(t,e){return this.size.contains(t-this.westX,e-this.northY)}index(t,e){return this.size.index(t-this.westX,e-this.northY)}containsOffset(t){return this.contains(t.x,t.y)}containsRectangle(t){if(0===t.width&&0===t.height)return!1;const e=t.westX-this.westX,i=t.northY-this.northY;return!!this.size.contains(e,i)&&this.size.contains(e+t.width-1,i+t.height-1)}overlapsRectangle(t){return this.northY<=t.northY+t.height-1&&this.southY>=t.northY&&this.westX<=t.westX+t.width-1&&this.eastX>=t.westX&&!this.empty&&0!==t.width&&0!==t.height}*offsets(){const{eastX:t,southY:e}=this;for(let i=this.northY;i<=e;i++)for(let e=this.westX;e<=t;e++)yield{x:e,y:i}}anyOf(t){for(const{x:e,y:i}of this.offsets())if(t(e,i))return!0;return!1}}},154:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Size=void 0;const r=i(74);e.Size=class{constructor(t,e){if(void 0===t&&(t=0),void 0===e&&(e=0),t<0||e<0)throw new Error(`bad size (${t}x${e})`);this.width=t,this.height=e}toString(){return`(${this.width}x${this.height})`}equals(t){return this.width===t.width&&this.height===t.height}get empty(){return 0===this.width||0===this.height}get area(){return this.width*this.height}set(t,e){if(t<0||e<0)throw new Error(`bad size (${t}x${e})`);return this.width=t,this.height=e,this}copyFrom(t){return this.set(t.width,t.height)}add(t,e){return this.width+=t,this.height+=e,this}multiply(t){return this.width*=t,this.height*=t,this}rotate(t){return r.axisFromNorthSouthTurn(t)===r.Axis.WEST_EAST&&this.set(this.height,this.width),this}contains(t,e){return t>=0&&e>=0&&t<this.width&&e<this.height}containsOffset(t){return this.contains(t.x,t.y)}index(t,e){return e*this.width+t}*offsets(){for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)yield{x:e,y:t}}anyOf(t){for(const{x:e,y:i}of this.offsets())if(t(e,i))return!0;return!1}}},457:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TransformRectangle=void 0;const r=i(82),n=i(74),s=i(317),o=i(154),a=new s.Offset,l=new s.Offset,h=new o.Size;e.TransformRectangle=class{constructor(t,e){this._size=new o.Size,this._flip=n.Flip.HEADS,this._rotate=n.CardinalTurn.NONE,this._translate=new s.Offset,this._matrix=[1,0,0,0,1,0],this._targetRect=new r.Rectangle,void 0===t||("number"==typeof t?this._size.set(t,e):this._size.copyFrom(t)),this._update()}toString(){return`[${this._size} -> ${n.flipToString(this._flip)} ${n.cardinalTurnToString(this._rotate)} ${this._translate} -> ${this._targetRect}]`}equals(t){return this._size.equals(t._size)&&this._flip===t._flip&&this._rotate===t._rotate&&this._translate.equals(t._translate)}get flip(){return this._flip}get rotate(){return this._rotate}get northY(){return this._translate.y}get southY(){return this._translate.y+this._targetRect.height-1}get westX(){return this._translate.x}get eastX(){return this._translate.x+this._targetRect.width-1}get width(){return this._targetRect.width}get height(){return this._targetRect.height}_update(){a.setFromCardinalDirection(n.cardinalDirectionFromNorthTurn(this._rotate));const t=this._flip===n.Flip.TAILS?-1:1;switch(this._matrix[0]=-a.y*t,this._matrix[1]=-a.x,this._matrix[2]=this._translate.x,this._matrix[3]=a.x*t,this._matrix[4]=-a.y,this._matrix[5]=this._translate.y,this._rotate){case n.CardinalTurn.NONE:this._flip===n.Flip.TAILS&&(this._matrix[2]+=this._size.width-1);break;case n.CardinalTurn.RIGHT:this._matrix[2]+=this._size.height-1,this._flip===n.Flip.TAILS&&(this._matrix[5]+=this._size.width-1);break;case n.CardinalTurn.AROUND:this._matrix[5]+=this._size.height-1,this._flip===n.Flip.HEADS&&(this._matrix[2]+=this._size.width-1);break;case n.CardinalTurn.LEFT:this._flip===n.Flip.HEADS&&(this._matrix[5]+=this._size.width-1)}return h.copyFrom(this._size).rotate(this._rotate),this._targetRect.set(this._translate.x,this._translate.y,h.width,h.height),this}copyFrom(t){return this._size.copyFrom(t._size),this._flip=t._flip,this._rotate=t._rotate,this._translate.copyFrom(t._translate),t._matrix.forEach(((t,e)=>this._matrix[e]=t)),this._targetRect.copyFrom(t._targetRect),this}reset(){return this._flip=n.Flip.HEADS,this._rotate=n.CardinalTurn.NONE,this._translate.set(0,0),this._update()}invert(){const t=n.cardinalTurnFromCardinalDirections(n.CardinalDirection.NORTH,n.cardinalDirectionFromCardinalOrientation(n.cardinalOrientationReverse(n.cardinalOrientationFromFlipAndCardinalDirection(this._flip,n.cardinalDirectionFromNorthTurn(this._rotate)))));return this._rotate=t,this._size.rotate(t),this._translate.multiply(-1),this._update()}setTransform(t,e,i){return this._flip=t,this._rotate=e,this._translate.copyFrom(i),this._update()}setFlip(t){return this._flip=t,this._update()}setRotate(t){return this._rotate=t,this._update()}setTranslate(t,e){return this._translate.set(t,e),this._update()}setTranslateOffset(t){return this._translate.copyFrom(t),this._update()}applyToCardinalOrientation(t){return this._flip===n.Flip.TAILS&&(t=n.cardinalOrientationFlip(t,n.Axis.NORTH_SOUTH)),n.cardinalOrientationAddCardinalTurn(t,this._rotate)}unapplyFromCardinalOrientation(t){return t=n.cardinalOrientationAddCardinalTurn(t,n.cardinalTurnReverse(this._rotate)),this._flip===n.Flip.TAILS&&(t=n.cardinalOrientationFlip(t,n.Axis.NORTH_SOUTH)),t}applyToCardinalDirection(t){return n.cardinalDirectionFromCardinalOrientation(this.applyToCardinalOrientation(n.cardinalOrientationFromFlipAndCardinalDirection(n.Flip.HEADS,t)))}unapplyFromCardinalDirection(t){return n.cardinalDirectionFromCardinalOrientation(this.unapplyFromCardinalOrientation(n.cardinalOrientationFromFlipAndCardinalDirection(n.Flip.HEADS,t)))}applyTo(t,e,i){const r=e*this._matrix[0]+i*this._matrix[1]+this._matrix[2],n=e*this._matrix[3]+i*this._matrix[4]+this._matrix[5];return t.set(r,n)}unapplyFrom(t,e,i){const r=e-this._matrix[2],n=i-this._matrix[5],s=r*this._matrix[0]+n*this._matrix[3],o=r*this._matrix[1]+n*this._matrix[4];return t.set(s,o)}applyToOffset(t,e){return void 0===e&&(e=t),this.applyTo(t,e.x,e.y)}unapplyFromOffset(t,e){return void 0===e&&(e=t),this.unapplyFrom(t,e.x,e.y)}applyToRectangle(t,e){return void 0!==e&&t.copyFrom(e),a.set(t.westX,t.northY),l.set(t.eastX,t.southY),this.applyToOffset(a),this.applyToOffset(l),t.setFromCorners(a,l)}unapplyFromRectangle(t,e){return void 0!==e&&t.copyFrom(e),a.set(t.westX,t.northY),l.set(t.eastX,t.southY),this.unapplyFromOffset(a),this.unapplyFromOffset(l),t.setFromCorners(a,l)}}},175:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||r(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),n(i(74),e),n(i(876),e)},725:function(t,e,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,i,r){void 0===r&&(r=i),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,r){void 0===r&&(r=i),t[r]=e[i]}),n=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&r(e,t,i);return n(e,t),e},o=this&&this.__read||function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o};Object.defineProperty(e,"__esModule",{value:!0});var a,l,h,u,c=s(i(254)),d=s(i(695)),f=document.getElementById("canvas").getContext("2d"),_=37,T=19,p=new Array(703);function g(t,e){return e*_+t}function O(){var t,e;do{t=Math.floor(Math.random()*_),e=Math.floor(Math.random()*T)}while(a.getWalls(t,e)||a.getBody(t,e));return[t,e]}function y(){f.fillStyle="#fff",f.fillRect(0,0,1184,608);for(var t=function(t){for(var e=function(e){p[g(e,t)].forEach((function(i){f.drawImage(m,32*v[i],0,32,32,32*e,32*t,32,32)})),e===h&&t===u&&f.drawImage(m,32*v.player,0,32,32,32*e,32*t,32,32)},i=0;i<_;i++)e(i)},e=0;e<T;e++)t(e);var i=c.computeFieldOfView(a,h,u,15);for(e=0;e<T;e++)for(var r=0;r<_;r++)i.getVisible(r,e)||f.drawImage(m,32*v.shadow,0,32,32,32*r,32*e,32,32)}var S=!0;window.addEventListener("keydown",(function(t){var e;if("ArrowUp"===t.key||"ArrowDown"===t.key||"ArrowLeft"===t.key||"ArrowRight"===t.key){var i=h,r=u,n=void 0;switch(t.key){case"ArrowUp":n=c.CardinalDirection.NORTH,r--;break;case"ArrowDown":n=c.CardinalDirection.SOUTH,r++;break;case"ArrowLeft":n=c.CardinalDirection.WEST,i--;break;case"ArrowRight":n=c.CardinalDirection.EAST,i++}i>=0&&r>=0&&i<_&&r<T&&!a.getWall(h,u,n)&&!a.getBody(i,r)&&(h=i,u=r,requestAnimationFrame(y)),t.preventDefault(),S=!1,null===(e=document.getElementById("takeover"))||void 0===e||e.remove()}}));var v={floor1:0,floor2:1,floor3:2,floor4:3,floor5:4,floor6:5,north:6,east:7,south:8,west:9,player:10,box1:11,box2:12,box3:13,shadow:14},m=new Image;m.src="./tiles.png",m.onload=function(){!function(){var t;!function(){a=new c.FieldOfViewMap(_,T),l=new d.js;for(var t=new Array,e=0;e<T;e++)t.push(new Array(_).fill(0));l.enableDiagonals(),l.setGrid(t),l.setAcceptableTiles([0]),l.enableSync();for(var i=.1,r=0;r<50;r++){var n=Math.floor(35*Math.random()+1);if(e=Math.floor(17*Math.random()+1),!a.getWalls(n,e))for(var s=Math.floor(4*Math.random()),o=Math.floor(7*Math.random()+2),h=0;h<o&&!(n<1||n>=36||e<1||e>=18);h++){a.addWall(n,e,s);var u=Math.random();switch(s){case c.CardinalDirection.NORTH:u<i?(s=c.CardinalDirection.WEST,n++,e--):u>.9?s=c.CardinalDirection.EAST:n++;break;case c.CardinalDirection.EAST:u<i?(s=c.CardinalDirection.NORTH,n++,e++):u>.9?s=c.CardinalDirection.SOUTH:e++;break;case c.CardinalDirection.SOUTH:u<i?(s=c.CardinalDirection.EAST,n--,e++):u>.9?s=c.CardinalDirection.WEST:n--;break;case c.CardinalDirection.WEST:u<i?(s=c.CardinalDirection.SOUTH,n--,e--):u>.9?s=c.CardinalDirection.NORTH:e--}}}for(e=0;e<T;e++)for(n=0;n<_;n++){var f=a.getWalls(n,e);if(0===f&&Math.random()<.08)a.addBody(n,e),t[e][n]=1;else{var p=[];0==(f&c.CardinalDirectionFlags.NORTH)&&p.push(d.TOP),0==(f&c.CardinalDirectionFlags.EAST)&&p.push(d.RIGHT),0==(f&c.CardinalDirectionFlags.SOUTH)&&p.push(d.BOTTOM),0==(f&c.CardinalDirectionFlags.WEST)&&p.push(d.LEFT),l.setDirectionalCondition(n,e,p)}}}(),t=o(O(),2),h=t[0],u=t[1],p.fill([]);for(var e=function(t){for(var e=function(e){var i=a.getWalls(e,t),r=p[g(e,t)]=[];Math.random()>.3&&r.push("floor"+Math.floor(1+6*Math.random())),0!=(i&c.CardinalDirectionFlags.NORTH)&&r.push("north"),0!=(i&c.CardinalDirectionFlags.EAST)&&r.push("east"),0!=(i&c.CardinalDirectionFlags.SOUTH)&&r.push("south"),0!=(i&c.CardinalDirectionFlags.WEST)&&r.push("west"),a.getBody(e,t)&&r.push("box"+Math.floor(1+3*Math.random())),r.forEach((function(i){f.drawImage(m,32*v[i],0,32,32,32*e,32*t,32,32)}))},i=0;i<_;i++)e(i)},i=0;i<T;i++)e(i)}();var t,e=!1;requestAnimationFrame((function i(){if(S){if(t)if(t.length>0){var r=t.shift();r&&(s=r.x,a=r.y,h=s,u=a)}else t=void 0;else{if(!e){var n=o(O(),2),s=n[0],a=n[1];return e=!0,l.findPath(h,u,s,a,(function(r){t=r,e=!1,requestAnimationFrame(i)})),void l.calculate()}l.calculate()}y(),setTimeout((function(){return requestAnimationFrame(i)}),120)}}))}}},e={};!function i(r){if(e[r])return e[r].exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,i),n.exports}(725)})();
//# sourceMappingURL=demo.js.map