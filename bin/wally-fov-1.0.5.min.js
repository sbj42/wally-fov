var WallyFov=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/bin/",i(i.s=1)}([function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||e.hasOwnProperty(i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(3),e),r(i(4),e),r(i(5),e),r(i(6),e),r(i(7),e),r(i(8),e),r(i(9),e)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2);Object.defineProperty(e,"FieldOfViewMap",{enumerable:!0,get:function(){return n.FieldOfViewMap}});var r=i(0);Object.defineProperty(e,"Direction",{enumerable:!0,get:function(){return r.Direction}}),Object.defineProperty(e,"DirectionFlags",{enumerable:!0,get:function(){return r.DirectionFlags}}),Object.defineProperty(e,"MaskRect",{enumerable:!0,get:function(){return r.MaskRect}})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FieldOfViewMap=void 0;var n,r=i(0);!function(t){t[t.WALL_NORTH=1]="WALL_NORTH",t[t.WALL_EAST=2]="WALL_EAST",t[t.WALL_WEST=8]="WALL_WEST",t[t.WALL_SOUTH=4]="WALL_SOUTH",t[t.BODY=1<<r.DIRECTIONS.length]="BODY"}(n||(n={}));var o=new r.Offset,s=function(){function t(t,e){this._size=new r.Size,this._size.set(t,e),this._tileFlags=new Array(this._size.area).fill(0)}return t.prototype._addFlag=function(t,e){var i=this._size.index(t);this._tileFlags[i]|=e},t.prototype._removeFlag=function(t,e){var i=this._size.index(t);this._tileFlags[i]&=~e},t.prototype.addWall=function(t,e,i){o.set(t,e),this._size.containsOffset(o)&&(this._addFlag(o,1<<i),o.addCardinalDirection(i),this._size.containsOffset(o)&&this._addFlag(o,1<<r.directionOpposite(i)))},t.prototype.removeWall=function(t,e,i){o.set(t,e),this._size.containsOffset(o)&&(this._removeFlag(o,1<<i),o.addCardinalDirection(i),this._size.containsOffset(o)&&this._removeFlag(o,1<<r.directionOpposite(i)))},t.prototype.getWalls=function(t,e){o.set(t,e);var i=this._size.index(o);return this._tileFlags[i]&r.DirectionFlags.ALL},t.prototype.getWall=function(t,e,i){return 0!=(this.getWalls(t,e)&1<<i)},t.prototype.addBody=function(t,e){o.set(t,e),this._addFlag(o,n.BODY)},t.prototype.removeBody=function(t,e){o.set(t,e),this._removeFlag(o,n.BODY)},t.prototype.getBody=function(t,e){o.set(t,e);var i=this._size.index(o);return 0!=(this._tileFlags[i]&n.BODY)},t.prototype.getFieldOfView=function(t,e,i){var n=new r.Offset(t,e),o=new r.Rectangle(n.x-i,n.y-i,2*i+1,2*i+1),s=new r.MaskRect(o);return s.set(n,!0),this._quadrant(s,n,i,-1,-1),this._quadrant(s,n,i,1,-1),this._quadrant(s,n,i,-1,1),this._quadrant(s,n,i,1,1),s},t.prototype._quadrant=function(t,e,i,r,o){var s=e.x,c=e.y,f=(Math.min(Math.max(s+r*(i+1),-1),this._size.width)-s)*r,h=(Math.min(Math.max(c+o*(i+1),-1),this._size.height)-c)*o;if(!(f<0||h<0))for(var a=1===o?n.WALL_SOUTH:n.WALL_NORTH,p=1===r?n.WALL_EAST:n.WALL_WEST,l=this._size.index(e),d=t.index(e),y=[0,Number.POSITIVE_INFINITY],g=0,_=l,O=d;g!==h&&y.length>0;g++,_+=o*this._size.width,O+=o*t.width)for(var b=1/(g+.5),v=0===g?Number.POSITIVE_INFINITY:1/(g-.5),m=0,S=0,w=_,T=O,F=-.5*b,x=.5*v;S!==f&&m!==y.length;S++,w+=r,T+=r,F+=b,x+=v){for(;F>=y[m+1]&&!((m+=2)>=y.length););if(m>=y.length)break;if(!(x<=y[m+0])){t.setAt(T,!0);var W=0!=(this._tileFlags[w]&a),j=0!=(this._tileFlags[w]&p);if(j&&W)m=u(y,m,F-1e-5/10,x+1e-5/10);else if((0!==S||0!==g)&&0!=(this._tileFlags[w]&n.BODY))m=j?u(y,m,F+1e-5,x+1e-5/10):u(y,m,W?F-1e-5/10:F+1e-5,x-1e-5);else if(j){m=u(y,m,F+b-1e-5/10,x+1e-5/10)}else if(W){m=u(y,m,F-1e-5/10,F+b+1e-5/10)}}}},t}();function u(t,e,i,n){for(;;){if(e===t.length)return e;if(i<=t[e+1])break;e+=2}if(i<=t[e+0]){if(n>=t[e+1])return t.splice(e,2),u(t,e,i,n);n>=t[e+0]&&(t[e+0]=n)}else{if(n>=t[e+1])return t[e+1]=i,u(t,e+=2,i,n);t.splice(e,0,t[e+0],i),t[(e+=2)+0]=n}return e}e.FieldOfViewMap=s},function(t,e,i){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.directionOpposite=e.DIRECTIONS=e.Direction=void 0,function(t){t[t.NORTH=0]="NORTH",t[t.EAST=1]="EAST",t[t.SOUTH=2]="SOUTH",t[t.WEST=3]="WEST"}(n=e.Direction||(e.Direction={})),e.DIRECTIONS=[n.NORTH,n.EAST,n.SOUTH,n.WEST],e.directionOpposite=function(t){return t+2&3}},function(t,e,i){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.directionFlagsFromDirection=e.directionFlagsToString=e.DirectionFlags=void 0,function(t){t[t.NONE=0]="NONE",t[t.NORTH=1]="NORTH",t[t.EAST=2]="EAST",t[t.SOUTH=4]="SOUTH",t[t.WEST=8]="WEST",t[t.ALL=15]="ALL"}(n=e.DirectionFlags||(e.DirectionFlags={})),e.directionFlagsToString=function(t){var e="[";return 0!=(t&n.NORTH)&&(e+="N"),0!=(t&n.EAST)&&(e+="E"),0!=(t&n.SOUTH)&&(e+="S"),0!=(t&n.WEST)&&(e+="W"),e+"]"},e.directionFlagsFromDirection=function(t){return 1<<t}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Offset=void 0;var n=[0,1,0,-1],r=[-1,0,1,0],o=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.addOffset=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.addCardinalDirection=function(t){return this.x+=n[t],this.y+=r[t],this},t.prototype.subtractOffset=function(t){return this.x-=t.x,this.y-=t.y,this},t}();e.Offset=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Size=void 0;var n=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.width=t,this.height=e}return t.prototype.toString=function(){return"("+this.width+"x"+this.height+")"},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.width||0===this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){return this.width=t,this.height=e,this},t.prototype.copyFrom=function(t){return this.width=t.width,this.height=t.height,this},t.prototype.containsOffset=function(t){return t.x>=0&&t.y>=0&&t.x<this.width&&t.y<this.height},t.prototype.index=function(t){return t.y*this.width+t.x},t.prototype.forEach=function(t,e){for(var i=0;i<this.height;i++)for(var n=0;n<this.width;n++)t.x=n,t.y=i,e(t)},t}();e.Size=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Rectangle=void 0;var n=i(0),r=new n.Offset,o=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.northWest=new n.Offset(t,e),this.size=new n.Size(i,r)}return t.prototype.toString=function(){return"("+this.westX+","+this.northY+" "+this.width+"x"+this.height+")"},Object.defineProperty(t.prototype,"northY",{get:function(){return this.northWest.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"southY",{get:function(){return this.northWest.y+this.size.height-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"westX",{get:function(){return this.northWest.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eastX",{get:function(){return this.northWest.x+this.size.width-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.size.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.size.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.size.area},enumerable:!1,configurable:!0}),t.prototype.copyFrom=function(t){return this.northWest.set(t.westX,t.northY),this.size.set(t.width,t.height),this},t.prototype.containsOffset=function(t){return this.size.containsOffset(r.copyFrom(t).subtractOffset(this.northWest))},t.prototype.index=function(t){return this.size.index(r.copyFrom(t).subtractOffset(this.northWest))},t}();e.Rectangle=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mask=void 0;var n=i(0),r=function(){function t(t,e){void 0===e&&(e=!1),this._size=new n.Size,this._size.copyFrom(t),this._bits=new Array(this._size.area).fill(e)}return t.prototype.toString=function(){for(var t="",e=new n.Offset,i=0;i<this._size.height;i++){for(var r=0;r<this._size.width;r++)e.set(r,i),t+=this.get(e.set(r,i))?"☑":"☐";t+="\n"}return t},Object.defineProperty(t.prototype,"width",{get:function(){return this._size.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._size.height},enumerable:!1,configurable:!0}),t.prototype.index=function(t){return this._size.index(t)},t.prototype.getAt=function(t){return this._bits[t]},t.prototype.get=function(t){return this.getAt(this.index(t))},t.prototype.setAt=function(t,e){return this._bits[t]=e,this},t.prototype.set=function(t,e){return this.setAt(this.index(t),e)},t.prototype.forEach=function(t,e){var i=this,n=0;this._size.forEach(t,(function(t){e(t,i._bits[n]),n++}))},t}();e.Mask=r},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MaskRect=void 0;var n=i(0),r=new n.Offset,o=function(){function t(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this._rectangle=new n.Rectangle,this._rectangle.copyFrom(t),this._mask=new n.Mask(t,e),this._outsideValue=i}return t.prototype.toString=function(){return this._rectangle.northWest+"/"+this._outsideValue+"\n"+this._mask},Object.defineProperty(t.prototype,"westX",{get:function(){return this._rectangle.westX},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"northY",{get:function(){return this._rectangle.northY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._rectangle.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._rectangle.height},enumerable:!1,configurable:!0}),t.prototype.index=function(t){return this._mask.index(r.copyFrom(t).subtractOffset(this._rectangle.northWest))},t.prototype.getAt=function(t){return this._mask.getAt(t)},t.prototype.get=function(t,e){return r.set(t,e),this._rectangle.containsOffset(r)?this._mask.get(r.subtractOffset(this._rectangle.northWest)):this._outsideValue},t.prototype.setAt=function(t,e){return this._mask.setAt(t,e),this},t.prototype.set=function(t,e){return this._mask.set(r.copyFrom(t).subtractOffset(this._rectangle.northWest),e),this},t.prototype.forEach=function(t,e){var i=this;this._mask.forEach(t,(function(t,n){e(t.addOffset(i._rectangle.northWest),n)}))},t}();e.MaskRect=o}]);
//# sourceMappingURL=wally-fov-1.0.5.min.js.map